<!DOCTYPE html>
<html>
	<!--References-->
	<!--http://leafletjs.com/examples/geojson.html-->
	<!--http://geojson.io/#map=2/20.0/0.0-->
<head>
  <meta charset=utf-8 />
  <title>Career Path</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  
  <!-- Load Leaflet from CDN-->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/leaflet/0.7.3/leaflet.css" />
  <script src="//cdn.jsdelivr.net/leaflet/0.7.3/leaflet.js"></script>
  
  <!--JQUERY-->
  <script src="./jquery.min.js"></script>
  
  <!-- Load Esri Leaflet from CDN -->
  <script src="//cdn.jsdelivr.net/leaflet.esri/1.0.0/esri-leaflet.js"></script>
  
 <style>
  	html, body, #map {
  		width: 100%;
  		height: 100%;
  	}
  	.legend {
               line-height: 18px;
               color: #555;
  	}
  	.legend i {
               width: 18px;
               height: 18px;
               float: left;
               margin-right: 8px;
               opacity: 0.7;
        }
</style>
</head>
<body>
    <div id="map"></div>
	
   <!--Create source for geoJson and copy leaflet.js source-->
	<script src="/Road-to-GIS-Professionalism/javascripts/Work.js" type="text/javascript"></script>
	<script src="/Road-to-GIS-Professionalism/javascripts/geojson.js" type="text/javascript"></script>
	<script src="../dist/leaflet.js"></script>

    <script>
		var map = L.map('map').setView([34.227700, -84.250717], 8);
		L.esri.basemapLayer ("Gray").addTo(map);
		//map.legendControl.addLegend(document.getElementById('legend').innerHTML);
		
		function getColor(p) {
                    return p >= 26 ? '#253494' :
                          p >=21 && p <=25.9 ? '#2c7fb8' :
                           p >=16.9 && p <= 20.9  ? '#41b6c4' :
                           p >=12.6 && p<=16.8 ? '#a1dab4' :
                                       '#ffffcc';
                }
                      //$.getJSON($('link[rel="polygon"]').attr("href"), function(data){
		      //var geojson = L.geoJson(data,{
		      //style:style,
		//	onEachFeature: function(feature,layer){
			//	layer.bindPopup (feature.properties.COUNTY+"<br>"+"Percent:"+" "+feature.properties.PerUnin)
			//	}
		   //   });
		
	            var legend = L.control ({position: 'bottomright'});
		
		    legend.onAdd = function (map) {
			
	            var div = L.DomUtil.create('div', 'info legend'),
                              lower = [2,12.6,16.9,21,26],
                              upper = [12.5,16.8,20.9,25.9,"plus"],
                              labels = [];

                        // loop through our density intervals and generate a label with a colored square for each interval
                    for (var i = 0; i < lower.length; i++) {
                            div.innerHTML +=
                                     '<i style="background:' + getColor(lower[i] + 1) + '"></i> ' +
                                      lower[i] + '&ndash;' + upper[i]+'<br>';
                        }

		
		    return div;
		};

		legend.addTo(map);
	
		function onEachFeature(feature, layer) {	
			//!----THIS ONE WORKS-1---!
			//var popupContent = '<p>Interactive Resume</p> <a href="http://www.cobbassessor.org/cobbga_dnn/Tax-Assessor/">Tax Assessors:  </a>';
			
			//!!----THIS ONE WORK-2----!!
			//var popupContent = '<div class="'+ feature.properties.Samaksa +'"><b>' + feature.properties.Title + '</b><br/>' +
                       // '<p>' + feature.properties.Description + '</p>' + '"/>' +
                        //'<p><em style="font-size: 0.8em"><a href="http://www.cobbassessor.org/cobbga_dnn/Tax-Assessor/">Tax Assessors:</a></em></p></div>';
			
			//!!!---THIS ONE WORKS-3---!!!
			//var popupContent = '<div class="'+ feature.properties.Samaksa +'"><b>' + feature.properties.Title + '</b><br/>' +
                        //'<p>' + feature.properties.Description + '</p>' + 
                        //'<p><em style="font-size: 0.8em"><a href="http://www.cobbassessor.org/cobbga_dnn/Tax-Assessor/">Tax Assessors:</a></em></p></div>';
			
			//!!!!----THIS ONE WORKS-4----!!!!
			//if (feature.properties.popupContent) {
                            //layer.bindPopup(feature.properties.popupContent);
			//}
			
			//!!!!!-----THIS WORKS--5----!!!!!!
			//var popupContent = '<div class='<p>'+ feature.properties.popupContent +'<p>'+ ><b>' + feature.properties.Title + '</b><br/>' +
                        //'<p>' + feature.properties.Description + '</p>' + 
                        //'<p><em style="font-size: 0.8em"><a href="http://www.cobbassessor.org/cobbga_dnn/Tax-Assessor/">Tax Assessors Website</a></em></p></div>';
			
			
			//layer.bindPopup(popupContent);
			
			//!!!!!!------Works--6------!!!!!!
			//var popupContent = '<div class=+ ><b>' + feature.properties.Title + '</b><br/>' +
                        //'<p>' + feature.properties.Description + '</p>' + 
                        //'<p><em style="font-size: 0.8em"><a href="http://www.cobbassessor.org/cobbga_dnn/Tax-Assessor/">Tax Assessors Website</a></em></p></div>';
			
			//layer.bindPopup(popupContent);
			
			var Work = '<div class=+ ><b>' + feature.properties.Title + '</b><br/>' +
                        '<p>' + feature.properties.Position + '</p>' + '<p>' + feature.properties.Duties + '<p/>' + '<p><em style="font-size: 0.8em"><a href="https://www.linkedin.com/pub/james-e-fitzgerald-gisp/31/ba5/ab9/">LinkedIn</a></em></p>' +
                        '<p><em style="font-size: 0.8em"><a href="http://www.cobbassessor.org/cobbga_dnn/Tax-Assessor/">Tax Assessors Website</a></em></p></div>';
			
			layer.bindPopup(Work);
		  }

		L.geoJson([Work], {

			style: function (feature) {
				return feature.properties && feature.properties.style;
			},

			onEachFeature: onEachFeature,

			pointToLayer: function (feature, latlng) {
				return L.circleMarker(latlng, {
					radius: 8,
					fillColor: "#ff7800",
					color: "#000",
					weight: 1,
					opacity: 1,
					fillOpacity: 0.8
				});
			}
		}).addTo(map);
		
		function onEachFeature(feature, layer) {
			var geojson = '<div class=+ ><b>' + feature.properties.Title + '</b><br/>' +
                        '<p>' + feature.properties.Position + '</p>' + '<p>' + feature.properties.Duties + '<p/>' + '<p><em style="font-size: 0.8em"><a href="https://www.linkedin.com/pub/james-e-fitzgerald-gisp/31/ba5/ab9/">LinkedIn</a></em></p>' +
                        '<p><em style="font-size: 0.8em"><a href="http://www.cobbassessor.org/cobbga_dnn/Tax-Assessor/">Tax Assessors Website</a></em></p></div>';
			
			layer.bindPopup(geojson);
		  }
		  
		L.geoJson([geojson], {

			style: function (feature) {
				return feature.properties && feature.properties.style;
			},

			onEachFeature: onEachFeature,

			pointToLayer: function (feature, latlng) {
				return L.circleMarker(latlng, {
					radius: 10,
					fillColor: "#f03b20",
					color: "#000",
					weight: 1,
					opacity: 1,
					fillOpacity: 0.8
				});
			}
		}).addTo(map);
      </script>   
</body>
</html>
